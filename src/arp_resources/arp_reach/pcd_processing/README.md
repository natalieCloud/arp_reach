# pcd_processing README

Howdy! You've found the readme for the pcd_processing package! This package is one of many co-developed alongside another in order to provide ``Reach`` functionality to the [ar_paint](https://github.com/OSU-AIMS/augmented-reality-painting) project!

What pcd processing does is that is provides a service node that would read in the client ``PoseArray`` and write those poses to desdignated filepath in the arp_reach and reach_ros packaegs! Once the `Poses` have been written to a `PCD` file, it's filepath will then be included in a `YAML` reach configuration file. which will also be stored in a designated directory. The service node will the return the filepath to the `YAML` file as its response in the form of a string!

![pcd_processing](https://github.com/natalieCloud/arp_reach/assets/123828141/ca1686a1-9c2c-4357-a593-1c004361914e)

Requirements to Build:
-------------------------

To sucessfully build this project one must have minimum [ROS 2 Humble](https://docs.ros.org/en/humble/Installation.html) installed, as well as [python3](https://www.python.org/downloads/) configs set up!

Also, the package [arp_msgs](https://github.com/natalieCloud/arp_reach/tree/main/src/arp_resources/arp_msgs) is nessesary for this package to build!

## Launch && Nodes

### [PoseArrayToPCDClient.cpp](https://github.com/natalieCloud/arp_reach/blob/main/src/arp_resources/arp_reach/pcd_processing/nodes/PoseArrayToPCDClient.cpp)

This class represents a type of client node from the FormatPosesToPCD.srv found in the `arp_msgs` package! The client sends a request that is comprised of a `PoseArray` to 
the service, which then processes it into a `PCD` file, whose filepath is then included into a `YAML` file (Used as the configuration file for `arp_reach`) The path to the configuration file is then handed back to the client, along with a boolean indicating sucess!

### [PoseArrayToPCDService.py](https://github.com/natalieCloud/arp_reach/blob/main/src/arp_resources/arp_reach/pcd_processing/nodes/PoseArrayToPCDService.cpp)

This node represents a type of service from the FormatPosesToPCD.srv found in the `arp_msgs` package! It takes in a request from the client which is comprised of a `PoseArray`, and then tries to run that `PoseArray` into the pcd_processor, and then the resulting `PCD` filepath into the `YAML` file creator! It then returns the `YAML` filepath and a boolean indicating sucess to the client, indicating whether or not to turn to phase 2 of the node series! :)

## Support Files

### [pose_array_to_pcd.py](https://github.com/natalieCloud/arp_reach/blob/main/src/arp_resources/arp_reach/pcd_processing/file_makers/pose_array_to_pcd.py)

*PoseArray to PCD Converter (*Now supporting the reverse for testing purposes!* ðŸ™‚)*

A file that processes a `PoseArray` generated by the current "path-planning" algorithm into a `PCD` format that is able to be processed by `ROS-Industrial Reach`!

*writeFile(waypoints, fname):*
- This function reads in a name of a file and a PoseArray and parses that PoseArray into a PCD format!
- waypoints : PoseArray<br>
      | The poses which will be converted to a pcd file
- fname : string<br>
      | The name of the file to be written to!
- returns:
      | An int indicating that the operation of writing to the file was a sucess!

*readPoses(fname):*
- This function mainly serves in testing the creation of a PoseArray by reading in poses from a PCD file! 
- fname : str<br>
      | The file that will be read from (Path will be determined by user)

### [yaml_file_maker.py](https://github.com/natalieCloud/arp_reach/blob/main/src/arp_resources/arp_reach/pcd_processing/file_makers/yaml_file_maker.py)

*Yaml File Writer*

This class takes a processed PCD file generated by the pcd (Also maybe optionally as well as any collsion meshes in the form of a ply file and a param determining the  endeffector distance though that would be in a seperate extension) And adds them to a yaml file, tagged appropriatly.

*writeYAML(pathname, fname):*
- This takes the information from poseArray and parses it into a yaml file that will be used as a parameter in the reach study!
- pathname : str<br>
      | The path of the pcd file to include!
- fname: str<br>
      | The name of the file to write to!
    
