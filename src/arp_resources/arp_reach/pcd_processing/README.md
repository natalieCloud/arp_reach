# pcd_processing README

Howdy! You've found the readme for the pcd_processing package! This package is one of many co-developed alongside another in order to provide ``Reach`` functionality to the [ar_paint](https://github.com/OSU-AIMS/augmented-reality-painting) project!

What pcd processing does is that is provides a service node that would read in the client ``PoseArray`` and write those poses to a file in the /tmp folder (Currently we are only setup to support Linux however an issue will be opened to make this package OS agnostic) Once the poses have been written to a pcd file, it's filepath will then be included in a yaml reach configuration file. which will also be stored in the tmp folder (changes pending) The service node will the returnm the filepath to the yaml file as its response in the form of a string!

Requirements to Build:
-------------------------

To sucessfully build this project one must have minimum [ROS 2 Humble](https://docs.ros.org/en/humble/Installation.html) installed, as well as [python3](https://www.python.org/downloads/) configs set up!

Also, the package [arp_msgs](https://github.com/natalieCloud/arp_reach/tree/main/src/arp_resources/arp_msgs) is nessesary for this package to build!

## Launch && Nodes

### PoseArrayToPCDClient.py

    A class to represent a Node object of type client that takes in a poseArray and 
    generates a pcd file from a service!
    
    ...

    Methods
    -------
    __init__(self):
        Initilizes the node and sends a request to the service should the service be active
        else, waits and tries again.

    send_request(self, waypoints):
        Assigns the waypoints to itself and spins until complete (May not be sucessful) returns
        the result!

### PoseArrayToPCDService.py

    A class to represent a Node object of type service that takes in a poseArray and 
    generates a pcd file from the file writer!
    
    ...

    Methods
    -------
    __init__(self):
        Initilizes the node and sends a request to the its function.

    process_pcd_callback(self, waypoints):
        Assigns the waypoints to itself and spins until complete (May not be sucessful) returns
        the result!

## Support Files

### pose_array_to_pcd.py

*PoseArray to PCD Converter (*Now supporting the reverse for testing purposes!* ðŸ™‚)*

A Python file that processes a PoseArray generated by the current "path-planning" algorithm into a pcd format that is able to be processed by ros-industrial reach!

    write_file(out_file_name, pose_arr):

    This takes the information from poseArray and parses it into a .pcd file that will allow us 
    to run the reach study

    Parameters
    ----------
        outFile : str
            The file that will be written to (Path wlll be determined by launch param?
            or maybe just be constant idk yet!
        poseArr : PoseArray
            The poseArray that all the information will be taken from!

<br>

    def read_poses(in_file_name):
    
    This takes the information in from a PCD file and parses it into a poseArray that will
    allow for ease of testing

    Parameters
    ----------
        in_file_name : str
            The file that will be read from (Path will be determined by user)

### yaml_file_maker.py

*Yaml File Writer*

A Python file that processes a generated pcd file made and inputs it into a yaml file that can be used by [arp_reach](https://github.com/natalieCloud/arp_reach/issues/24)

    def write_yaml(out_file_name, pcd_filename):
    
    This takes the information from poseArray and parses it into a yaml file that will be
    used as a parameter in the reach study!

    Parameters
    ----------
        out_file_name : str
            The file that will be written to!
        pcd_filename: str
            The file that needs to be included as the pcd file!
    
